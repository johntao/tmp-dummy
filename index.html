<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>轉檔小幫手2.0</title>
</head>
<body>
    拖拉這個連結到書籤列
    <a href="data:text/html;charset=utf-8;base64,PGh0bWw+CjxoZWFkPgogIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KICA8dGl0bGU+VGVzdDwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CiAgPHN0eWxlPgogICAgbGFiZWw6Zmlyc3QtY2hpbGQgewogICAgICBwYWRkaW5nOiAwLjNyZW0gMC41cmVtOwogICAgICBiYWNrZ3JvdW5kOiAjMDA3YmZmOwogICAgICBjb2xvcjogd2hpdGU7CiAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICB9CiAgICBsYWJlbDpmaXJzdC1jaGlsZDpob3ZlciB7CiAgICAgIGJhY2tncm91bmQ6ICMwMDU2YjM7CiAgICB9CiAgICBociB7CiAgICAgIG1hcmdpbi1ibG9jazogMXJlbTsKICAgIH0KICAgIGgzIHsKICAgICAgbWFyZ2luLWJsb2NrOiAwLjVyZW07CiAgICB9CiAgICBpbnB1dFt0eXBlPSJmaWxlIl0gewogICAgICBkaXNwbGF5OiBub25lOwogICAgfQogIDwvc3R5bGU+CiAgPGRpdj4KICAgIDxsYWJlbD7pu57miJHpgbjmk4fmlZnogrLoqJPnt7Q8aW5wdXQgaWQ9Il94IiB0eXBlPSJmaWxlIiAvPjwvbGFiZWw+CiAgICA8aDM+5qyE5L2N5Y+D5pW46Kit5a6aPC9oMz4KICAgIDxsYWJlbD7oqJPnt7Tllq7kvY06IDxpbnB1dCBpZD0iX3gxIiB2YWx1ZT0i5Z+66ZqG6ZW35bqaIiAvPjwvbGFiZWw+CiAgICA8bGFiZWw+6KiT57e06Kqy56iLOiA8aW5wdXQgaWQ9Il94MiIgdmFsdWU9IjAxIiAvPjwvbGFiZWw+CiAgICA8bGFiZWw+6Kqy56iL6aCY5Z+fOiA8aW5wdXQgaWQ9Il94MyIgdmFsdWU9IkEwMCIgLz48L2xhYmVsPgogIDwvZGl2PgogIDxociAvPgogIDxkaXY+CiAgICA8bGFiZWw+6bue5oiR6YG45pOH6LuK6aSQ6LK7PGlucHV0IGlkPSJfeSIgdHlwZT0iZmlsZSIgLz48L2xhYmVsPgogICAgPGgzPuashOS9jeWPg+aVuOioreWumjwvaDM+CiAgICA8bGFiZWw+5pyN5YuZ6aCF55uuOiA8aW5wdXQgaWQ9Il95MSIgdmFsdWU9IjAxMTAiIC8+PC9sYWJlbD4KICAgIDxsYWJlbD7mnI3li5nlhaflrrk6IDxpbnB1dCBpZD0iX3kyIiB2YWx1ZT0iMDAwNSIgLz48L2xhYmVsPgogIDwvZGl2PgogIDxzY3JpcHQ+CiAgICBmdW5jdGlvbiBzZXR1cEZpbGVIYW5kbGVyKGlucHV0SWQsIHByb2Nlc3Nvciwgc3VjY2Vzc01lc3NhZ2UpIHsKICAgICAgd2luZG93W2lucHV0SWRdLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb3B5KHByb2Nlc3NvcihldmVudC50YXJnZXQucmVzdWx0KS5qb2luKCdcbicpKTsKICAgICAgICAgICAgYWxlcnQoc3VjY2Vzc01lc3NhZ2UpOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICAgICAgYWxlcnQoZXJyLm1lc3NhZ2UpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZS50YXJnZXQuZmlsZXNbMF0sICdiaWc1Jyk7CiAgICAgIH0pOwogICAgfQoKICAgIHNldHVwRmlsZUhhbmRsZXIoJ194JywgcHJvY2Vzc1RyYWluLCAn5bey6KSH6KO95pWZ6IKy6KiT57e06Iez5Ymq6LK857C/77yBJyk7CiAgICBzZXR1cEZpbGVIYW5kbGVyKCdfeScsIHByb2Nlc3NTZXJ2aWNlLCAn5bey6KSH6KO96LuK6aSQ6LK76Iez5Ymq6LK857C/77yBJyk7CgogICAgZnVuY3Rpb24gY29weSh2YWx1ZSkgewogICAgICBpZiAobmF2aWdhdG9yLmNsaXBib2FyZD8ud3JpdGVUZXh0KSB7CiAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodmFsdWUpLmNhdGNoKCgpID0+IGZhbGxiYWNrQ29weSh2YWx1ZSkpOwogICAgICB9IGVsc2UgewogICAgICAgIGZhbGxiYWNrQ29weSh2YWx1ZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmYWxsYmFja0NvcHkodGV4dCkgewogICAgICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7CiAgICAgIHRleHRhcmVhLnZhbHVlID0gdGV4dDsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7CiAgICAgIHRleHRhcmVhLnNlbGVjdCgpOwogICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpOwogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRleHRhcmVhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRJbnB1dFZhbHVlKGlkLCBkZWZhdWx0VmFsdWUpIHsKICAgICAgcmV0dXJuIHdpbmRvd1tpZF0udmFsdWUgfHwgZGVmYXVsdFZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIHByb2Nlc3NUcmFpbih0eHQpIHsKICAgICAgbGV0IG5hbWVzID0gW10sIGlkcyA9IFtdOwogICAgICBjb25zdCBOQU1FX1BPU1ggPSAiNDUwMCI7CiAgICAgIGNvbnN0IElEX1BPU1ggPSAiMjQzMCI7CiAgICAgIC8vIFJlZ2V4IHBhdHRlcm4gZnJvbSBQYXJzZUJvZHkoKQogICAgICBjb25zdCBib2R5UmVnZXggPSAvXHtcXHBhcmQgXFxxYyBcXHB2cGdcXHBocGdcXHBvc3goNDUwMHwyNDMwKVxccG9zeVxkK1xcYWJzd1xkKyBcXGFic2gtMjcwIFx7XFxmMVxcZnMyNCBcXGNmMSAoPyFcXGIgKSguKylcXHBhclx9XH0vZzsKICAgICAgbGV0IG1hdGNoOwogICAgICB3aGlsZSAoKG1hdGNoID0gYm9keVJlZ2V4LmV4ZWModHh0KSkgIT09IG51bGwpIHsKICAgICAgICBpZiAobWF0Y2hbMV0gPT09IE5BTUVfUE9TWCkgbmFtZXMucHVzaChtYXRjaFsyXSk7CiAgICAgICAgZWxzZSBpZiAobWF0Y2hbMV0gPT09IElEX1BPU1gpIGlkcy5wdXNoKG1hdGNoWzJdKTsKICAgICAgfQogICAgICBpZiAobmFtZXMubGVuZ3RoICE9PSBpZHMubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLlp5PlkI3oiIfouqvliIborYnmlbjph4/kuI3nrKbvvIEiKTsKICAgICAgfQoKICAgICAgbGV0IENsc0RhdGUgPSAiIiwgQ2xzTmFtZSA9ICIiLCBDbHNIb3VyID0gIiI7CiAgICAgIC8vIFJlZ2V4IHBhdHRlcm4gZnJvbSBQYXJzZUhlYWQoKQogICAgICBjb25zdCBoZWFkUmVnZXggPSAvXHtcXHBhcmQgXFxxW2NsXSBcXHB2cGdcXHBocGdcXHBvc3hcZCtcXHBvc3lcZCtcXGFic3dcZCsgXFxhYnNoLTI3MCBce1xcZjFcXGZzMjQgXFxjZjEgXFxiICguKz8pXFxwYXJcfVx9L2c7CiAgICAgIGxldCBpZHggPSAtMTsKICAgICAgd2hpbGUgKChtYXRjaCA9IGhlYWRSZWdleC5leGVjKHR4dCkpICE9PSBudWxsKSB7CiAgICAgICAgY29uc3QgaW5uZXJUZXh0ID0gbWF0Y2hbMV07CiAgICAgICAgaWR4Kys7CiAgICAgICAgaWYgKGlkeCA9PT0gMCkgewogICAgICAgICAgY29uc29sZS5sb2coYOWOn+Wni+aXpeacn++8miR7aW5uZXJUZXh0fWApOwogICAgICAgICAgQ2xzRGF0ZSA9IGAke3BhcnNlSW50KGlubmVyVGV4dC5zdWJzdHJpbmcoMCwgNCkpIC0gMTkxMX0ke2lubmVyVGV4dC5zdWJzdHJpbmcoNCl9YDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoaWR4ID09PSAyKSBDbHNOYW1lID0gaW5uZXJUZXh0OwogICAgICAgIGVsc2UgaWYgKGlkeCA9PT0gMykgQ2xzSG91ciA9IGlubmVyVGV4dDsKICAgICAgfQoKICAgICAgY29uc3QgVHJhaW5PcmcgPSBnZXRJbnB1dFZhbHVlKCdfeDEnLCAi5Z+66ZqG6ZW35bqaIik7CiAgICAgIGNvbnN0IENsc0NvZGUxID0gZ2V0SW5wdXRWYWx1ZSgnX3gyJywgIjAxIik7CiAgICAgIGNvbnN0IENsc0NvZGUyID0gZ2V0SW5wdXRWYWx1ZSgnX3gzJywgIkEwMCIpOwogICAgICAvKgogICAgICAq5aeT5ZCNCSrouqvliIborYnlrZfomZ8JKuWPl+iok+aXpeacn+i1twkq5Y+X6KiT5pel5pyf6L+ECSvoqJPnt7Tllq7kvY0JK+iok+e3tOiqsueoiwkr6Kqy56iL6aCY5Z+fCSvoqJPnt7TmrKHmlbgJKuiok+e3tOaZguaVuC3lsI/mmYIJK+iok+e3tOaZguaVuC3liIbpkJgJK+aguOWumuWtl+iZnwkr5qC45a6a5pel5pyfCSroqrLnqIvlkI3nqLEJK+WCmeiouwkr5Yyv5YWl5YuV5L2cCiAgICAgIOmZtua3teaYjglGMTI4Mzg2MTY4CTEwODAzMDkJMTA4MDMwOQkgICAg5Z+66ZqG6ZW35bqaCTAxCSAgICAgICBBMDAJICAgICAgMQkgICAgICAgIDMJICAgICAgICAgIDAJCQkJICAgICAgICAgICAgICAgICAgICAgICAgIOeXheS6uuiHquS4u+asiuWIqeazleS7iwkJQQogICAgICAqLwogICAgICByZXR1cm4gbmFtZXMubWFwKChuYW1lLCBpKSA9PiBgJHtuYW1lfVx0JHtpZHNbaV19XHQke0Nsc0RhdGV9XHQke0Nsc0RhdGV9XHQke1RyYWluT3JnfVx0JHtDbHNDb2RlMX1cdCR7Q2xzQ29kZTJ9XHQxXHQke0Nsc0hvdXJ9XHQwXHRcdFx0JHtDbHNOYW1lfVx0XHRBYCk7CiAgICB9CgogICAgZnVuY3Rpb24gcHJvY2Vzc1NlcnZpY2UodHh0KSB7CiAgICAgIGxldCBuYW1lcyA9IFtdLCBpZHMgPSBbXSwgaG91cnMgPSBbXSwgbWVhbHMgPSBbXSwgdHJpcHMgPSBbXTsKICAgICAgY29uc3QgTkFNRV9QT1NYID0gIjI5MDUiOwogICAgICBjb25zdCBJRF9QT1NYID0gIjEyNDAiOwogICAgICBjb25zdCBIT1VSX1BPU1ggPSAiNTcwNCI7CiAgICAgIGNvbnN0IFRSSVBfUE9TWCA9ICI3MjY0IjsKICAgICAgY29uc3QgTUVBTF9QT1NYID0gIjg3NTMiOwogICAgICAvLyBSZWdleCBwYXR0ZXJuIGZyb20gUGFyc2VTZXJ2aWNlKCkKICAgICAgY29uc3Qgc2VydmljZVJlZ2V4ID0gL1x7XFxwYXJkIFxccVtjbF0gXFxwdnBnXFxwaHBnXFxwb3N4KDM2ODV8MTI0MHwyOTA1fDU3MDR8NzI2NHw4NzUzKVxccG9zeVxkK1xcYWJzd1xkKyBcXGFic2gtMjcwIFx7XFxmMVxcZnMyMiBcXGNmMSAoLis/KVxccGFyXH1cfS9nOwogICAgICBsZXQgbWF0Y2g7CiAgICAgIHdoaWxlICgobWF0Y2ggPSBzZXJ2aWNlUmVnZXguZXhlYyh0eHQpKSAhPT0gbnVsbCkgewogICAgICAgIGNvbnN0IHBvc1ggPSBtYXRjaFsxXTsKICAgICAgICBjb25zdCBpbm5lclRleHQgPSBtYXRjaFsyXTsKICAgICAgICBpZiAocG9zWCA9PT0gTkFNRV9QT1NYKSBuYW1lcy5wdXNoKGlubmVyVGV4dCk7CiAgICAgICAgZWxzZSBpZiAocG9zWCA9PT0gSURfUE9TWCkgaWRzLnB1c2goaW5uZXJUZXh0KTsKICAgICAgICBlbHNlIGlmIChwb3NYID09PSBIT1VSX1BPU1gpIGhvdXJzLnB1c2goaW5uZXJUZXh0KTsKICAgICAgICBlbHNlIGlmIChwb3NYID09PSBUUklQX1BPU1gpIHRyaXBzLnB1c2goaW5uZXJUZXh0KTsKICAgICAgICBlbHNlIGlmIChwb3NYID09PSBNRUFMX1BPU1gpIG1lYWxzLnB1c2goaW5uZXJUZXh0KTsKICAgICAgfQogICAgICBpZiAobmFtZXMubGVuZ3RoICE9PSBpZHMubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLlp5PlkI3oiIfouqvliIborYnmlbjph4/kuI3nrKbvvIEiKTsKICAgICAgfQoKICAgICAgLy8gUmVnZXggcGF0dGVybiBmcm9tIFBhcnNlRGF0ZSgpCiAgICAgIGNvbnN0IGRhdGVSZWdleCA9IC9ce1xccGFyZCBcXHFyIFxccHZwZ1xccGhwZ1xccG9zeFxkK1xccG9zeVxkK1xcYWJzd1xkKyBcXGFic2gtXGQrIFx7XFxmMVxcZnMyNCBcXGNmMSAoXGR7Nn0pXFxwYXJcfVx9LzsKICAgICAgbWF0Y2ggPSBkYXRlUmVnZXguZXhlYyh0eHQpOwogICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLmib7kuI3liLDml6XmnJ/vvIEiKTsKICAgICAgfQoKICAgICAgY29uc3QgZFN0ciA9IG1hdGNoWzFdOwogICAgICAvLyBQYXJzZSB5eXl5TU0gZm9ybWF0IGFuZCBhZGQgMSBtb250aCwgdGhlbiBzdWJ0cmFjdCAxIGRheSB0byBnZXQgbGFzdCBkYXkgb2YgbW9udGgKICAgICAgY29uc3QgeWVhciA9IHBhcnNlSW50KGRTdHIuc3Vic3RyaW5nKDAsIDQpKTsKICAgICAgY29uc3QgbW9udGggPSBwYXJzZUludChkU3RyLnN1YnN0cmluZyg0LCA2KSk7CiAgICAgIGNvbnN0IGR0ID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDApOyAvLyBtb250aCArIDEsIGRheSAwID0gbGFzdCBkYXkgb2YgbW9udGgKICAgICAgY29uc3QgY2hZZWFyID0gZHQuZ2V0RnVsbFllYXIoKSAtIDE5MTE7CiAgICAgIGNvbnN0IG1vbnRoU3RyID0gU3RyaW5nKGR0LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICBjb25zdCBkYXlTdHIgPSBTdHJpbmcoZHQuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICBjb25zdCBEU3RhcnQgPSBgJHtjaFllYXJ9JHttb250aFN0cn0wMWA7CiAgICAgIGNvbnN0IERFbmQgPSBgJHtjaFllYXJ9JHttb250aFN0cn0ke2RheVN0cn1gOwoKICAgICAgY29uc3QgU0VSVklDRV9UWVBFID0gZ2V0SW5wdXRWYWx1ZSgnX3kxJywgIjAxMTAiKTsKICAgICAgY29uc3QgU0VSVklDRV9JVEVNID0gZ2V0SW5wdXRWYWx1ZSgnX3kyJywgIjAwMDUiKTsKICAgICAgLyoKICAgICAgKuWnk+WQjQkq6Lqr5YiG6K2J5a2X6JmfCSvmnI3li5nml6XmnJ/otbcJK+acjeWLmeaXpeacn+i/hAkh5pyN5YuZ6aCF55uuCSHmnI3li5nlhaflrrkJKuacjeWLmeaZguaVuC3lsI/mmYIJKuacjeWLmeaZguaVuC3liIbpkJgJIeWPl+acjeWLmeS6uuasoQkq5Lqk6YCa6LK7CSroqqTppJDosrsJIeacjeWLmeWNgOWfnwkh5YKZ6Ki7CSHljK/lhaXli5XkvZwKICAgICAg6YOt5a2Q5YSACUYxMjgyNTYwNzggIDEwODAzMDEJICAxMDgwMzMxCTAxMTAJICAgMDAwNQkgICAgICAzCSAgICAgICAgICAgIDAJICAgICAgICAgICAwCSAgICAxMDAgICAgMjAwCSAgQyAgICAgICAgICAgICAgICAgQQogICAgICAgICAgcmV0dXJuICQie05hbWV9XHR7Q0lkfVx0e0RTdGFydH1cdHtERW5kfVx0e1UuQ29uZmlnLlNlcnZpY2VUeXBlfVx0e1UuQ29uZmlnLlNlcnZpY2VJdGVtfVx0e0hvdXJ9XHR7TWludXRlfVx0MFx0e1RyaXBGZWV9XHR7TWVhbEZlZX1cdENcdFx0QSI7CiAgICAgICovCiAgICAgIHJldHVybiBuYW1lcy5tYXAoKG5hbWUsIGkpID0+IHsKICAgICAgICBsZXQgaG91ciA9IGhvdXJzW2ldOwogICAgICAgIGxldCBtaW51dGUgPSAiMCI7CiAgICAgICAgaWYgKGhvdXIuaW5jbHVkZXMoJy4nKSkgewogICAgICAgICAgbWludXRlID0gIjMwIjsgLy8gcmVtb3ZlICIuNSIKICAgICAgICAgIGhvdXIgPSBob3VyLnN1YnN0cmluZygwLCBob3VyLmxlbmd0aCAtIDIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYCR7bmFtZX1cdCR7aWRzW2ldfVx0JHtEU3RhcnR9XHQke0RFbmR9XHQke1NFUlZJQ0VfVFlQRX1cdCR7U0VSVklDRV9JVEVNfVx0JHtob3VyfVx0JHttaW51dGV9XHQwXHQke3RyaXBzW2ldfVx0JHttZWFsc1tpXX1cdENcdFx0QWA7CiAgICAgIH0pOwogICAgfQogIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K">
    轉檔小幫手
    </a>
</body>
</html>
